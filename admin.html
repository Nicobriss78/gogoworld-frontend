<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard — GoGoWorld.life</title>

  <!-- Base API (già usata dal resto del FE) -->
  <meta name="api-base" content="https://gogoworld-api.onrender.com/api" />

  <link rel="stylesheet" href="style.css" />
  <style>
    /* Mini-stili specifici admin (non invasivi) */
    .admin-wrap { max-width: 1200px; margin: 0 auto; padding: 1rem; }
    .admin-header { display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1rem; }
    .admin-title { font-size:1.4rem; font-weight:700; }
    .admin-tabs { display:flex; gap:.5rem; }
    .admin-tabs button { padding:.5rem .75rem; border:1px solid #ddd; background:#f9f9f9; cursor:pointer; }
    .admin-tabs button.active { background:#111; color:#fff; border-color:#111; }
    .admin-toolbar { display:flex; gap:.5rem; flex-wrap:wrap; margin:.75rem 0; }
    .admin-grid { display:grid; grid-template-columns: 1fr; gap:.75rem; }
    .admin-card { border:1px solid #eee; border-radius:8px; padding:.75rem; background:#fff; }
    .admin-card h3 { margin:0 0 .5rem 0; font-size:1.05rem; }
    .badge { display:inline-block; padding:.15rem .5rem; font-size:.8rem; border-radius:999px; border:1px solid #ddd; background:#f5f5f5; }
    .badge.approved { background:#e9f9ef; border-color:#bde5c8; }
    .badge.pending { background:#fff6e5; border-color:#f3d19e; }
    .badge.rejected { background:#fdecec; border-color:#f4b5b5; }
    .badge.blocked { background:#eee; border-color:#ccc; }
    .actions { display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.5rem; }
    .actions .btn { padding:.35rem .6rem; border:1px solid #ddd; background:#fafafa; cursor:pointer; }
    .actions .btn.primary { background:#111; color:#fff; border-color:#111; }
    .kpis { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:.75rem; margin:.75rem 0; }
    .kpi { padding:.75rem; border:1px solid #eee; border-radius:8px; background:#fff; }
    .kpi strong { display:block; font-size:1.2rem; }
    @media (max-width: 768px) {
      .kpis { grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    .table { width:100%; border-collapse: collapse; }
    .table th, .table td { padding:.5rem; border-bottom:1px solid #eee; text-align:left; }
    .muted { color:#777; }
    .search-input { padding:.4rem .55rem; border:1px solid #ddd; border-radius:6px; min-width:220px; }
    .select-input { padding:.4rem .55rem; border:1px solid #ddd; border-radius:6px; }
    .right { margin-left:auto; }
  </style>
</head>

<body>
  <div class="admin-wrap">
    <header class="admin-header">
      <div class="admin-title">Admin Dashboard</div>
      <nav class="admin-tabs" id="adminTabs">
        <button data-tab="events" class="active">Eventi</button>
        <button data-tab="users">Utenti</button>
        <button data-tab="imports">Import Massivo</button>
      </nav>
    </header>

    <!-- KPI -->
    <section class="kpis" id="kpiBar" aria-label="KPI principali">
      <div class="kpi"><span class="muted">Pending</span><strong id="kpiPending">-</strong></div>
      <div class="kpi"><span class="muted">Approved</span><strong id="kpiApproved">-</strong></div>
      <div class="kpi"><span class="muted">Rejected</span><strong id="kpiRejected">-</strong></div>
      <div class="kpi"><span class="muted">Blocked</span><strong id="kpiBlocked">-</strong></div>
    </section>

    <!-- Tabs content -->
    <main id="adminContent" class="admin-grid">
      <!-- Tab: Eventi -->
      <section data-tab-panel="events">
        <div class="admin-toolbar">
          <input id="evSearch" class="search-input" type="search" placeholder="Cerca titolo, città, categoria..." />
          <select id="evStatus" class="select-input">
          <option value="">Tutti gli stati</option>
          <option value="approved">Approved</option>
          <option value="pending">Pending</option>
          <option value="rejected">Rejected</option>
          <option value="blocked">Blocked</option>
          </select>
          <select id="evVisibility" class="select-input">
          <option value="">All</option>
          <option value="public">Public</option>
          <option value="private">Private</option>
          </select>
          <button id="evRefresh" class="btn">Aggiorna</button>
          <span class="right muted">Seleziona un evento per moderarlo</span>
        </div>

        <div id="eventsList" class="admin-grid"></div>
      </section>

      <!-- Tab: Utenti -->
      <section data-tab-panel="users" hidden>
        <div class="admin-toolbar">
          <input id="usSearch" class="search-input" type="search" placeholder="Cerca nome o email..." />
          <select id="usRole" class="select-input">
            <option value="">Tutti i ruoli</option>
            <option value="participant">Participant</option>
            <option value="organizer">Organizer</option>
            <option value="admin">Admin</option>
          </select>
          <select id="usOrg" class="select-input">
            <option value="">Può organizzare?</option>
            <option value="true">Sì</option>
            <option value="false">No</option>
          </select>
          <select id="usBan" class="select-input">
            <option value="">Bannati?</option>
            <option value="true">Sì</option>
            <option value="false">No</option>
          </select>
          <button id="usRefresh" class="btn">Aggiorna</button>
        </div>

        <div id="usersList" class="admin-grid"></div>
      </section>

      <!-- Tab: Import Massivo -->
      <section data-tab-panel="imports" hidden>
        <div class="admin-toolbar">
          <input id="impSimulate" type="checkbox" checked /> <label for="impSimulate">Simulazione</label>
          <button id="impRun" class="btn">Esegui import (CSV già configurato)</button>
          <span class="right muted">L’import usa l’endpoint /api/admin/import/events</span>
        </div>

        <!-- PATCH INSERITA: campo per il file CSV -->
        <div class="form">
          <div class="form-row">
            <label for="impFile">Seleziona file CSV</label>
            <input id="impFile" type="file" accept=".csv,text/csv" />
          </div>
        </div>
        <!-- FINE PATCH -->

        <div id="importResults" class="admin-card">
          <h3>Risultati import</h3>
          <pre id="importLog" class="muted">Nessun import eseguito.</pre>
        </div>
      </section>
    </main>
  </div>

  <script type="module" src="js/admin.js"></script>
</body>
</html>
