<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard — GoGoWorld.life</title>

  <!-- Base API (già usata dal resto del FE) -->


  <link rel="stylesheet" href="style.css" />
  <style> 
    /* Mini-stili specifici admin (non invasivi) */
    .admin-wrap { max-width: 1200px; margin: 0 auto; padding: 1rem; }
    .admin-header { display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1rem; }
    .admin-title { font-size:1.4rem; font-weight:700; }
    .admin-tabs { display:flex; gap:.5rem; }
    .admin-tabs button { padding:.5rem .75rem; border:1px solid #ddd; background:#f9f9f9; cursor:pointer; }
    .admin-tabs button.active { background:#111; color:#fff; border-color:#111; }
    .admin-toolbar { display:flex; gap:.5rem; flex-wrap:wrap; margin:.75rem 0; }
    .admin-grid { display:grid; grid-template-columns: 1fr; gap:.75rem; }
    .admin-card { border:1px solid #eee; border-radius:8px; padding:.75rem; background:#fff; }
    .admin-card h3 { margin:0 0 .5rem 0; font-size:1.05rem; }
    .badge { display:inline-block; padding:.15rem .5rem; font-size:.8rem; border-radius:999px; border:1px solid #ddd; background:#f5f5f5; }
    .badge.approved { background:#e9f9ef; border-color:#bde5c8; }
    .badge.pending { background:#fff6e5; border-color:#f3d19e; }
    .badge.rejected { background:#fdecec; border-color:#f4b5b5; }
    .badge.blocked { background:#eee; border-color:#ccc; }
    .actions { display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.5rem; }
    .actions .btn { padding:.35rem .6rem; border:1px solid #ddd; background:#fafafa; cursor:pointer; }
    .actions .btn.primary { background:#111; color:#fff; border-color:#111; }
    .kpis { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:.75rem; margin:.75rem 0; }
    .kpi { padding:.75rem; border:1px solid #eee; border-radius:8px; background:#fff; }
    .kpi strong { display:block; font-size:1.2rem; }
    @media (max-width: 768px) {
      .kpis { grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    .table { width:100%; border-collapse: collapse; }
    .table th, .table td { padding:.5rem; border-bottom:1px solid #eee; text-align:left; }
    .muted { color:#777; }
    .search-input { padding:.4rem .55rem; border:1px solid #ddd; border-radius:6px; min-width:220px; }
    .select-input { padding:.4rem .55rem; border:1px solid #ddd; border-radius:6px; }
    .right { margin-left:auto; }
    /* --- Dropdown Banner --- */
.menu-group { position:relative; }
.menu-toggle { padding:.5rem .75rem; border:1px solid #ddd; background:#f9f9f9; cursor:pointer; }
.menu-toggle.active { background:#111; color:#fff; border-color:#111; }
.menu-dropdown { position:absolute; top:110%; left:0; min-width:220px; border:1px solid #ddd; background:#fff; border-radius:8px; box-shadow:0 4px 18px rgba(0,0,0,.08); display:none; z-index:10; }
.menu-dropdown button { display:block; width:100%; text-align:left; padding:.5rem .75rem; border:0; background:#fff; cursor:pointer; }
.menu-dropdown button:hover { background:#f5f5f5; }    
.menu-current { margin-left: 12px; font-size: .9rem; color: #666; }
.btn.primary { background:#111; color:#fff; border-color:#111; }
.btn.primary:hover { background:#000; color:#fff; }

  </style>
</head>

<body>
  <div class="admin-wrap">
    <header class="admin-header">
      <div class="admin-title">Admin Dashboard</div>
      <nav class="admin-tabs" id="adminTabs">
<!-- Dropdown Sezioni -->
        <span class="menu-group">
          <button type="button" id="sectionsMenuBtn" class="menu-toggle">Sezioni ▾</button>
          <span class="menu-dropdown" id="sectionsMenu">
            <button type="button" data-tab="events">Eventi</button>
            <button type="button" data-tab="users">Utenti</button>
            <button type="button" data-tab="imports">Import Massivo</button>
            <button type="button" data-tab="reviews">Recensioni</button>
            <button type="button" data-tab="sponsor">Sponsor</button>
            <button type="button" data-tab="house">House</button>
            <button type="button" data-tab="approvals">Richieste da approvare</button>
            <button type="button" data-tab="banners">Banner</button>
          </span>
        </span>
       <span id="currentTabLabel" class="menu-current">Attuale: Eventi</span>
      </nav>
      <button id="btnAdminLogout" class="btn">Logout</button>
    </header>

    <!-- KPI -->
    <section class="kpis" id="kpiBar" aria-label="KPI principali">
      <div class="kpi"><span class="muted">Pending</span><strong id="kpiPending">-</strong></div>
      <div class="kpi"><span class="muted">Approved</span><strong id="kpiApproved">-</strong></div>
      <div class="kpi"><span class="muted">Rejected</span><strong id="kpiRejected">-</strong></div>
      <div class="kpi"><span class="muted">Blocked</span><strong id="kpiBlocked">-</strong></div>
    </section>

    <!-- Tabs content -->
    <main id="adminContent" class="admin-grid">
      <!-- Tab: Eventi -->
      <section data-tab-panel="events">
        <div class="admin-toolbar">
          <input id="evSearch" class="search-input" type="search" placeholder="Cerca titolo, città, categoria..." />
          <select id="evStatus" class="select-input">
          <option value="">Tutti gli stati</option>
          <option value="approved">Approved</option>
          <option value="pending">Pending</option>
          <option value="rejected">Rejected</option>
          <option value="blocked">Blocked</option>
          </select>
          <select id="evVisibility" class="select-input">
          <option value="">All</option>
          <option value="public">Public</option>
          <option value="private">Private</option>
          </select>
          <button id="evRefresh" class="btn">Aggiorna</button>
          <span class="right muted">Seleziona un evento per moderarlo</span>
        </div>

        <div id="eventsList" class="admin-grid"></div>
      </section>

      <!-- Tab: Utenti -->
      <section data-tab-panel="users" hidden>
        <div class="admin-toolbar">
          <input id="usSearch" class="search-input" type="search" placeholder="Cerca nome o email..." />
          <select id="usRole" class="select-input">
            <option value="">Tutti i ruoli</option>
            <option value="participant">Participant</option>
            <option value="organizer">Organizer</option>
            <option value="admin">Admin</option>
          </select>
          <select id="usOrg" class="select-input">
            <option value="">Può organizzare?</option>
            <option value="true">Sì</option>
            <option value="false">No</option>
          </select>
          <select id="usBan" class="select-input">
            <option value="">Bannati?</option>
            <option value="true">Sì</option>
            <option value="false">No</option>
          </select>
          <select id="usStatus" class="select-input">
            <option value="">Tutti gli status</option>
            <option value="novizio">Novizio</option>
            <option value="esploratore">Esploratore</option>
            <option value="veterano">Veterano</option>
            <option value="ambassador">Ambassador</option>
          </select>
          <input id="usScoreMin" class="search-input" type="number" min="0" step="1" placeholder="Score min" />
          <input id="usScoreMax" class="search-input" type="number" min="0" step="1" placeholder="Score max" />
          <button id="usRefresh" class="btn">Aggiorna</button>
          <button id="usReset" class="btn">Reset</button>
          <button id="usExport" class="btn">Export CSV</button>

        </div>

        <div id="usersList" class="admin-grid"></div>
        <div id="usersPager" class="pager"></div>
      </section>
<!-- TAB Banner -->
<section id="tab-banners" data-tab-panel="banners" hidden>
    <h2>Gestione Banner</h2>
    <div class="filters">
      <label>Stato:
        <select id="bannerFilterStatus">
          <option value="">Tutti</option>
          <option value="active">Active</option>
          <option value="paused">Paused</option>
          <option value="expired">Expired</option>
        </select>
      </label>
      <label>Placement:
        <input id="bannerFilterPlacement" type="text" placeholder="es. home_top">
      </label>
    </div>
    <table id="bannerTable">
      <thead>
        <tr>
          <th>Titolo</th>
          <th>Tipo</th>
          <th>Placement</th>
          <th>Area</th>
          <th>Inizio</th>
          <th>Fine</th>
          <th>Imp</th>
          <th>Click</th>
          <th>CTR</th>
          <th>Stato</th>
          <th>Azioni</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>
      <!-- Tab: Import Massivo -->
      <section data-tab-panel="imports" hidden>
        <div class="admin-toolbar">
          <!-- PATCH 1: rinominato Simulazione in Validazione -->
          <input id="impSimulate" type="checkbox" checked /> <label for="impSimulate">Validazione</label>
          
          <!-- PATCH 2: eliminato testo tra parentesi -->
          <button id="impRun" class="btn">Esegui import CSV</button>
          <input id="impFile" type="file" accept=".csv,text/csv" />
          <span id="impFileName" class="muted">Nessun file selezionato</span>
        </div>

        <div id="importResults" class="admin-card">
          <h3>Risultati import</h3>
          <pre id="importLog" class="muted">Nessun import eseguito.</pre>
        </div>
      </section>
      <!-- Tab: Recensioni -->
      <section data-tab-panel="reviews" hidden>
<div class="admin-toolbar">
    <label for="revEvent" class="muted">Evento:</label>
    <select id="revEvent">
      <option value="all">Tutti</option>
    </select>
    <button id="revRefresh" class="btn">Aggiorna</button>
    <span class="right muted">Recensioni pending in attesa di moderazione</span>
  </div>
        <div id="reviewsList" class="admin-grid"></div>
      </section>
      <!-- Tab: Sponsor (admin_third_party) -->
      <section data-tab-panel="sponsor" hidden>
        <div class="admin-card">
          <h3>Crea Sponsorizzazione Terzi</h3>
          <div class="admin-grid">
            <label>Titolo <input id="spTitle" class="search-input" type="text" placeholder="Titolo banner" /></label>
            <label>Immagine (URL https) <input id="spImage" class="search-input" type="url" placeholder="https://..." /></label>
            <label>Destinazione (URL https) <input id="spTarget" class="search-input" type="url" placeholder="https://..." /></label>
            <label>Placement
              <select id="spPlacement" class="select-input">
                <option value="events_list_inline">events_list_inline</option>
              </select>
            </label>
            <label>Paese (ISO-2) <input id="spCountry" class="search-input" type="text" placeholder="IT" /></label>
            <label>Regione <input id="spRegion" class="search-input" type="text" placeholder="Basilicata" /></label>
            <label>Inizio <input id="spFrom" class="search-input" type="datetime-local" /></label>
            <label>Fine <input id="spTo" class="search-input" type="datetime-local" /></label>
            <label>Priorità <input id="spPriority" class="search-input" type="number" value="100" /></label>
            <label><input id="spActive" type="checkbox" checked /> Attivo</label>
          </div>
          <div class="actions">
            <button id="spCreate" class="btn primary">Crea sponsor</button>
            <span class="muted">type=sponsor • source=admin_third_party • pagamento esterno</span>
          </div>
        </div>

        <div class="admin-card">
          <h3>Elenco Sponsor</h3>
          <div class="admin-toolbar">
            <button id="spRefresh" class="btn">Aggiorna</button>
          </div>
          <div id="sponsorList" class="admin-grid"></div>
        </div>
      </section>

      <!-- Tab: House (annunci piattaforma) -->
      <section data-tab-panel="house" hidden>
        <div class="admin-card">
          <h3>Crea Annuncio Piattaforma (House)</h3>
          <div class="admin-grid">
            <label>Titolo <input id="hsTitle" class="search-input" type="text" placeholder="Titolo banner" /></label>
            <label>Immagine (URL https) <input id="hsImage" class="search-input" type="url" placeholder="https://..." /></label>
            <label>Destinazione (URL https) <input id="hsTarget" class="search-input" type="url" placeholder="https://..." /></label>
            <label>Placement
              <select id="hsPlacement" class="select-input">
                <option value="events_list_inline">events_list_inline</option>
              </select>
            </label>
            <label>Paese (ISO-2) <input id="hsCountry" class="search-input" type="text" placeholder="IT" /></label>
            <label>Regione <input id="hsRegion" class="search-input" type="text" placeholder="Basilicata" /></label>
            <label>Inizio <input id="hsFrom" class="search-input" type="datetime-local" /></label>
            <label>Fine <input id="hsTo" class="search-input" type="datetime-local" /></label>
            <label>Priorità <input id="hsPriority" class="search-input" type="number" value="100" /></label>
            <label><input id="hsActive" type="checkbox" checked /> Attivo</label>
          </div>
          <div class="actions">
            <button id="hsCreate" class="btn primary">Crea house</button>
            <span class="muted">type=house • source=admin_house</span>
          </div>
        </div>

        <div class="admin-card">
          <h3>Elenco Annunci House</h3>
          <div class="admin-toolbar">
            <button id="hsRefresh" class="btn">Aggiorna</button>
          </div>
          <div id="houseList" class="admin-grid"></div>
        </div>
      </section>

      <!-- Tab: Richieste da approvare (organizer) -->
      <section data-tab-panel="approvals" hidden>
        <div class="admin-card">
          <h3>Richieste Organizzatori — In attesa</h3>
          <div class="admin-toolbar">
            <button id="apRefresh" class="btn">Aggiorna</button>
          </div>
          <div id="approvalsList" class="admin-grid"></div>
        </div>
      </section>
    </main>
  </div>

  <script type="module" src="js/admin.js"></script>
  <script>
    // Listener globale per retry API (503/502/504)
    window.addEventListener("api:status", (e) => {
      const { phase, attempt, status } = e.detail || {};
      if (phase === "retry") {
        try {
          showAlert(`⏳ Server in riattivazione… (tentativo ${attempt})`, "info", { autoHideMs: 1500 });
        } catch {
          console.info("Server in riattivazione… tentativo", attempt, "status", status);
        }
      }
    });
    // --- Banner dropdown toggle ---
// --- Sezioni dropdown toggle ---
    (function(){
      const btn = document.getElementById("sectionsMenuBtn");
      const menu = document.getElementById("sectionsMenu");
      if (btn && menu) {
        btn.addEventListener("click", () => {
          const open = menu.style.display === "block";
          menu.style.display = open ? "none" : "block";
          btn.classList.toggle("active", !open);
        });
        document.addEventListener("click", (e) => {
          if (!menu.contains(e.target) && e.target !== btn) {
            menu.style.display = "none";
            btn.classList.remove("active");
          }
        });
        // Chiude il menu quando scegli una voce; l’handler dei tab
        // (già in admin.js) si attiva sul click di [data-tab]
        menu.addEventListener("click", () => {
          menu.style.display = "none";
          btn.classList.remove("active");
        });
      }
    })();
// --- Etichetta sezione corrente ---
(function(){
  const label = document.getElementById("currentTabLabel");
  if (!label) return;
  function setCurrent(name) {
    label.textContent = "Attuale: " + name;
  }
  // iniziale: prova a leggere il tab attivo, altrimenti "Eventi"
  document.addEventListener("DOMContentLoaded", () => {
    const activePanel = document.querySelector('[data-tab-panel]:not([hidden])');
    const fallback = "Eventi";
    setCurrent(activePanel ? (activePanel.getAttribute("data-tab-panel") || fallback) : fallback);
  });
  // ogni click su una voce con data-tab aggiorna l’etichetta
  document.addEventListener("click", (e) => {
    const t = e.target;
    if (t && t.getAttribute && t.hasAttribute("data-tab")) {
      const name = t.getAttribute("data-tab") || "Eventi";
      setCurrent(name);
    }
  });
})();
// === API helper (via Netlify Function adminModeration) ===
function adminApi(path) {
  return "/.netlify/functions/adminModeration" + path;
}
async function adminFetch(path, opts) {
  const o = opts || {};
const token = (typeof localStorage !== "undefined" && localStorage.getItem("token")) || "";
  const headers = { "Content-Type": "application/json" };
  if (token) headers["Authorization"] = "Bearer " + token;
  const init = Object.assign({ method: "GET", headers, cache: "no-store" }, o);
  const res = await fetch(adminApi(path), init);
  if (!res.ok && res.status !== 204) {
    let t = "";
    try { t = await res.text(); } catch {}
    throw new Error("HTTP " + res.status + ": " + (t || res.statusText));
  }
  if (res.status === 204) return null;
  return res.json();
}

// === Render card banner ===
function renderBannerCard(b) {
  var status = (b.status || "-").toString().toLowerCase();
  var badge = '<span class="badge ' + status + '">' + (b.status || "-") + "</span>";
  return [
    '<div class="admin-card">',
    ' <h3>' + (b.title || '(senza titolo)') + ' ' + badge + '</h3>',
    ' <div class="muted">type: ' + b.type + ' • source: ' + b.source + ' • placement: ' + b.placement + '</div>',
    ' <div class="muted">geo: ' + (b.country || '—') + ' / ' + (b.region || '—') + ' • priority: ' + (b.priority || 100) + '</div>',
    ' <div class="muted">metrics: imp ' + (b.impressionsTotal || 0) + ' • click ' + (b.clicksTotal || 0) + ' • CTR ' + (b.impressionsTotal ? ((b.clicksTotal / b.impressionsTotal) * 100).toFixed(2) + '%' : '0%') + '</div>',
    ' <div class="muted">durata: ' + (b.activeFrom ? new Date(b.activeFrom).toLocaleString() : '—') + ' → ' + (b.activeTo ? new Date(b.activeTo).toLocaleString() : '—') + '</div>',
    ' <div class="actions">',
    ' <button class="btn" data-action="pause" data-id="' + b._id + '">Pausa</button>',
    ' <button class="btn" data-action="resume" data-id="' + b._id + '">Riprendi</button>',
    ' <button class="btn" data-action="delete" data-id="' + b._id + '">Elimina</button>',
    ' <a class="btn" href="' + b.imageUrl + '" target="_blank" rel="noopener">Immagine</a>',
    ' <a class="btn" href="' + b.targetUrl + '" target="_blank" rel="noopener">Landing</a>',
    ' </div>',
    '</div>'
  ].join('\n');
}

// === Sponsor: create + list ===
async function sponsorList() {
  var box = document.getElementById("sponsorList");
  if (!box) return;
  box.innerHTML = '<div class="muted">Caricamento…</div>';
  var q = await adminFetch("/api/banners?type=sponsor&source=admin_third_party&_=" + Date.now());
  var arr = (q && q.data) || [];
  box.innerHTML = arr.length ? arr.map(renderBannerCard).join("") : '<div class="muted">Nessuno sponsor presente.</div>';
}
async function sponsorCreate() {
  var body = {
    type: "sponsor",
    source: "admin_third_party",
    status: "ACTIVE",
    title: document.getElementById("spTitle").value.trim(),
    imageUrl: document.getElementById("spImage").value.trim(),
    targetUrl: document.getElementById("spTarget").value.trim(),
    placement: document.getElementById("spPlacement").value,
    country: (document.getElementById("spCountry").value || "").trim() || null,
    region: (document.getElementById("spRegion").value || "").trim() || null,
    activeFrom: document.getElementById("spFrom").value ? new Date(document.getElementById("spFrom").value).toISOString() : null,
    activeTo: document.getElementById("spTo").value ? new Date(document.getElementById("spTo").value).toISOString() : null,
    priority: Number(document.getElementById("spPriority").value || 100),
    isActive: document.getElementById("spActive").checked
  };
  await adminFetch("/api/banners", { method: "POST", body: JSON.stringify(body) });
  await sponsorList();
  try { showAlert("Sponsor creato", "success"); } catch {}
}

// === House: create + list ===
async function houseList() {
  var box = document.getElementById("houseList");
  if (!box) return;
  box.innerHTML = '<div class="muted">Caricamento…</div>';
  var q = await adminFetch("/api/banners?type=house&source=admin_house&_=" + Date.now());
  var arr = (q && q.data) || [];
  box.innerHTML = arr.length ? arr.map(renderBannerCard).join("") : '<div class="muted">Nessun annuncio house presente.</div>';
}
async function houseCreate() {
  var body = {
    type: "house",
    source: "admin_house",
    status: "ACTIVE",
    title: document.getElementById("hsTitle").value.trim(),
    imageUrl: document.getElementById("hsImage").value.trim(),
    targetUrl: document.getElementById("hsTarget").value.trim(),
    placement: document.getElementById("hsPlacement").value,
    country: (document.getElementById("hsCountry").value || "").trim() || null,
    region: (document.getElementById("hsRegion").value || "").trim() || null,
    activeFrom: document.getElementById("hsFrom").value ? new Date(document.getElementById("hsFrom").value).toISOString() : null,
    activeTo: document.getElementById("hsTo").value ? new Date(document.getElementById("hsTo").value).toISOString() : null,
    priority: Number(document.getElementById("hsPriority").value || 100),
    isActive: document.getElementById("hsActive").checked
  };
  await adminFetch("/api/banners", { method: "POST", body: JSON.stringify(body) });
  await houseList();
  try { showAlert("Annuncio house creato", "success"); } catch {}
}

// === Approvals (organizer) ===
async function approvalsList() {
  var box = document.getElementById("approvalsList");
  if (!box) return;
  box.innerHTML = '<div class="muted">Caricamento…</div>';
  var q = await adminFetch("/api/banners?status=PENDING_REVIEW&source=organizer&_=" + Date.now());
var arr = ((q && q.data) || []).filter(function (b) {
  return b && b.status === "PENDING_REVIEW" && b.source === "organizer";
});
  if (!arr.length) {
    box.innerHTML = '<div class="muted">Nessuna richiesta in attesa.</div>';
    return;
  }
  box.innerHTML = arr.map(function(b){
    var badge = '<span class="badge pending">PENDING_REVIEW</span>';
    return [
      '<div class="admin-card">',
      ' <h3>' + (b.title || '(senza titolo)') + ' ' + badge + '</h3>',
      ' <div class="muted">evento: ' + (b.eventId || '—') + ' • placement: ' + b.placement + ' • geo: ' + (b.country || '—') + '/' + (b.region || '—') + '</div>',
      ' <div class="actions">',
      ' <button class="btn primary" data-action="approve" data-id="' + b._id + '">Approva</button>',
      ' <button class="btn" data-action="reject" data-id="' + b._id + '">Rifiuta</button>',
      ' </div>',
      '</div>'
    ].join('\n');
  }).join('');
}

// === Deleghe click (pause/resume/delete/approve/reject) ===
document.addEventListener("click", async function(e){
  var t = e.target;
  if (!t || !t.getAttribute) return;
  var id = t.getAttribute("data-id");
  var action = t.getAttribute("data-action");
  if (!action || !id) return;
  try {
    if (action === "delete") {
      await adminFetch("/api/banners/" + id, { method: "DELETE" });
      sponsorList(); houseList(); approvalsList();
    }
    if (action === "pause") {
      await adminFetch("/api/banners/" + id + "/pause", { method: "POST" });
      sponsorList(); houseList(); approvalsList();
    }
    if (action === "resume") {
      await adminFetch("/api/banners/" + id + "/resume", { method: "POST" });
      sponsorList(); houseList(); approvalsList();
    }
    if (action === "approve") {
      await adminFetch("/api/banners/" + id + "/approve", { method: "POST" });
      try { showAlert("Banner approvato", "success"); } catch {}
      approvalsList();
    }
    if (action === "reject") {
      await adminFetch("/api/banners/" + id + "/reject", { method: "POST" });
      try { showAlert("Banner rifiutato", "info"); } catch {}
      approvalsList();
    }
  } catch (err) {
    try { showAlert(err.message || "Errore operazione", "error"); } catch { console.error(err); }
  }
});

// === Bind bottoni create/refresh ===
document.addEventListener("DOMContentLoaded", function(){
  function byId(id){ return document.getElementById(id); }
  var spCreate = byId("spCreate"); if (spCreate) spCreate.addEventListener("click", function(){ sponsorCreate().catch(console.error); });
  var spRefresh = byId("spRefresh"); if (spRefresh) spRefresh.addEventListener("click", function(){ sponsorList().catch(console.error); });
  var hsCreate = byId("hsCreate"); if (hsCreate) hsCreate.addEventListener("click", function(){ houseCreate().catch(console.error); });
  var hsRefresh = byId("hsRefresh"); if (hsRefresh) hsRefresh.addEventListener("click", function(){ houseList().catch(console.error); });
  var apRefresh = byId("apRefresh"); if (apRefresh) apRefresh.addEventListener("click", function(){ approvalsList().catch(console.error); });
});

// === Auto-load quando si apre un pannello ===
document.addEventListener("click", function(e){
  var t = e.target;
  if (!t || !t.getAttribute || !t.hasAttribute("data-tab")) return;
  var tab = t.getAttribute("data-tab");
  if (tab === "sponsor") sponsorList();
  if (tab === "house") houseList();
  if (tab === "approvals") approvalsList();
});

  </script>
</body>
</html>
