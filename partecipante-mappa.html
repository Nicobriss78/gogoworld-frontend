<!DOCTYPE html>
<html lang="it">
<head>
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GoGoWorld.life â€“ Area Partecipante</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
  <meta name="robots" content="noindex" />
  
</head>
<body>
  <main class="container participant">
<header class="gw-topbar">
  <!-- Riga 1: saluto + logo -->
  <div class="gw-topbar-row gw-topbar-row--title">
    <div class="gw-greeting">
      <div class="gw-hello">Ciao <span id="gwUserName">ğŸ‘¤</span></div>
      <div class="gw-status" id="gwUserStatus">Partecipante</div>
    </div>

    <div class="gw-brand">
      <!-- TODO: metteremo il tuo logo reale -->
      <span class="gw-brandtext">GoGoWorld.life</span>
    </div>
  </div>

  <!-- Riga 2: azioni -->
  <div class="gw-topbar-row gw-topbar-row--actions">
    <a class="gw-iconbtn" href="pages/cerca-utenti.html" title="Cerca" aria-label="Cerca">
      <span class="gw-ico">ğŸ”</span>
    </a>

<button class="gw-iconbtn" id="btnGeo" title="Posizione" aria-label="Posizione">
      <span class="gw-ico">ğŸ“</span>
    </button>

    <a class="gw-iconbtn" href="messages.html" title="Messaggi" aria-label="Messaggi">
      <span class="gw-ico">âœ‰ï¸</span>
      <span id="messagesBadge" class="gw-badge" style="display:none">0</span>
    </a>

<button class="gw-iconbtn" id="btnNotifications" title="Notifiche" aria-label="Notifiche">
  <span class="gw-ico">ğŸ””</span>
  <span id="notiBadge" class="gw-badge" style="display:none">0</span>
</button>


    <button class="gw-iconbtn" id="btnHamburger" title="Menu" aria-label="Menu">
      <span class="gw-ico">â‰¡</span>
    </button>
  </div>

  <!-- Menu hamburger -->
  <div id="gwMenu" class="gw-menu" style="display:none">
    <a href="pages/cerca-utenti.html">Cerca utente</a>
    <a href="#" id="btnPrivateEvents">Eventi privati</a>
    <a href="#" id="btnGuide">Guida partecipante</a>
    <a href="#" id="btnSwitchRole">Cambia ruolo</a>
    <a href="#" id="btnLogout" class="danger">Logout</a>
  </div>
</header>
<!-- MAPPA (tra topbar e bottom bar) -->
<section class="gw-map">
  <!-- BLOCCO 1: MAPPA -->
  <section class="gw-block">
    <div class="gw-block-head">
      <h2 class="gw-block-title">Mappa eventi</h2>
    </div>

    <section id="mapSection">
      <div id="map"></div>
    </section>

    <!-- Legenda (resta sotto la mappa) -->
    <div id="mapLegend" class="map-legend">
      <span class="legend-item">
        <span class="legend-dot legend-dot-ongoing"></span>In corso
      </span>
      <span class="legend-item">
        <span class="legend-dot legend-dot-imminent"></span>Imminente
      </span>
      <span class="legend-item">
        <span class="legend-dot legend-dot-future"></span>In arrivo
      </span>
    </div>
  </section>

  <!-- BLOCCO 2: EVENTO SELEZIONATO -->
  <section class="gw-block">
    <div class="gw-block-head">
      <h2 class="gw-block-title">Evento selezionato</h2>
    </div>

    <div id="mapSelectedEvent" class="gw-map-empty">
      Seleziona un evento sulla mappa per vedere i dettagli qui.
    </div>
  </section>

  <!-- BLOCCO 3: CHAT EVENTO -->
  <section class="gw-block">
    <div class="gw-block-head">
      <h2 class="gw-block-title">Chat evento</h2>
    </div>

    <div id="mapChatPanel" class="gw-map-empty">
      Seleziona un evento per aprire la chat qui sotto.
    </div>

    <div id="mapChatComposer" style="display:none">
      <input id="mapChatInput" type="text" placeholder="Scrivi un messaggio..." autocomplete="off" />
      <button id="mapChatSend" class="btn">Invia</button>
    </div>
  </section>
</section>
<nav class="gw-bottomnav">
  <a class="gw-navitem is-active" href="partecipante-mappa.html" title="Mappa"><span>ğŸ—ºï¸</span></a>
  <a class="gw-navitem" href="partecipante-seguiti-eventi.html" title="Eventi seguiti"><span>ğŸ§­</span></a>

  <a class="gw-navitem gw-navitem--home" href="partecipante.html" title="Home">
    <span>âŒ‚</span>
  </a>

  <a class="gw-navitem" href="partecipante-seguiti-utenti.html" title="Utenti seguiti"><span>ğŸ‘¥</span></a>
  <a class="gw-navitem" href="profilo.html" title="Profilo"><span>â˜º</span></a>
</nav>
    <footer class="app-footer">
      GoGoWorld.life â€“ Area Partecipante
    </footer>
  </main>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
  <script type="module" src="js/partecipante.js"></script>
<script>
  // Listener globale per messaggi di stato API (lo teniamo)
  window.addEventListener("api:status", (e) => {
    const { phase, attempt, status } = (e && e.detail) || {};
    if (phase === "retry") {
      try {
        showAlert(`â³ Server in riattivazioneâ€¦ (tentativo ${attempt})`, "info", { autoHideMs: 1500 });
      } catch {}
      console.info("Server in riattivazioneâ€¦ tentativo", attempt, "status", status);
    }
  });
</script>

  <!-- Badge Messaggi/Room -->
<script type="module" src="js/notifications.js"></script>
</body>
</html>


